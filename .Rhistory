mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.45, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.4, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
(shotmap_br | shotmap_de)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.45, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.45, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
(shotmap_br | shotmap_de)
(shotmap_br | shotmap_de) +
plot_annotation(title = 'The surprising truth about mtcars')
(shotmap_br + shotmap_de) +
plot_annotation(title = 'The surprising truth about mtcars')
(shotmap_br + shotmap_de) / xg_timeline
xg_timeline / (shotmap_br + shotmap_de)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
xg_timeline / (shotmap_br + shotmap_de)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8), legend.text.align = 0) +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
xg_timeline / (shotmap_br + shotmap_de)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8), legend.box.just = "center") +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
xg_timeline / (shotmap_br + shotmap_de)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8), legend.box.just = "right") +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
xg_timeline / (shotmap_br + shotmap_de)
theme_set(theme_minimal())
xg_timeline <- ggplot(data = cum_xg_ext, aes(x = minute_ext, y = cum_xg, color = team)) +
geom_step() +
geom_point(data = cum_xg_ext[cum_xg_ext$isGoal==1,], aes(x = minute_ext, y = cum_xg, color = team)) +
scale_colour_manual(values = c("Brasilien" = "seagreen", "Deutschland" = "grey50")) +
scale_x_continuous(breaks = seq(from = 0, to = 90, by = 15)) +
geom_vline(xintercept = 45, linetype = "dotted", color = "gray", size = 0.5) +
annotate("text", x = 70, y = 1.1, colour = "seagreen", size = 2, label = "Brasilien erarbeitet fast den gesamten \n xG-Wert in der 2. Hälfte als das Spiel \n eigentlich schon gelaufen ist") +
annotate("text", x = 15, y = 1.75, colour = "grey50", size = 2, label = "Deutschland führt zur Pause 5:0 durch \n schnelle Tore zwischen Minute 11 und 29 \n mit einem summierten xG-Wert von 1.28") +
geom_curve(aes(x = 5, y = 1.5, xend = 20, yend = 1.0), arrow = arrow(length = unit(0.03, "npc")), colour = "grey50", size = 0.2 ) +
labs(x = "Spielminute",
y = "kumulative xG",
title = glue::glue("xG-Entwicklung und Shotmaps<b style = 'color:seagreen'>Brasilien</b> - <b style = 'color:grey50'>Deutschland</b>"),
subtitle = "Halbfinale WM 2014: Estadio Mineirão, 8. Juli 2014") +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
theme(legend.position = 'none', plot.title = element_markdown())
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8), legend.box.just = "right") +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
xg_timeline / (shotmap_br + shotmap_de)
theme_set(theme_minimal())
xg_timeline <- ggplot(data = cum_xg_ext, aes(x = minute_ext, y = cum_xg, color = team)) +
geom_step() +
geom_point(data = cum_xg_ext[cum_xg_ext$isGoal==1,], aes(x = minute_ext, y = cum_xg, color = team)) +
scale_colour_manual(values = c("Brasilien" = "seagreen", "Deutschland" = "grey50")) +
scale_x_continuous(breaks = seq(from = 0, to = 90, by = 15)) +
geom_vline(xintercept = 45, linetype = "dotted", color = "gray", size = 0.5) +
annotate("text", x = 70, y = 1.1, colour = "seagreen", size = 2, label = "Brasilien erarbeitet fast den gesamten \n xG-Wert in der 2. Hälfte als das Spiel \n eigentlich schon gelaufen ist") +
annotate("text", x = 15, y = 1.75, colour = "grey50", size = 2, label = "Deutschland führt zur Pause 5:0 durch \n schnelle Tore zwischen Minute 11 und 29 \n mit einem summierten xG-Wert von 1.28") +
geom_curve(aes(x = 5, y = 1.5, xend = 20, yend = 1.0), arrow = arrow(length = unit(0.03, "npc")), colour = "grey50", size = 0.2 ) +
labs(x = "Spielminute",
y = "kumulative xG",
title = glue::glue("xG-Entwicklung und Shotmaps: <b style = 'color:seagreen'>Brasilien</b> - <b style = 'color:grey50'>Deutschland</b>"),
subtitle = "Halbfinale WM 2014: Estadio Mineirão, 8. Juli 2014") +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
theme(legend.position = 'none', plot.title = element_markdown())
xg_timeline / (shotmap_br + shotmap_de)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide = TRUE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8), legend.box.just = "right") +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle")) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8), legend.box.just = "right") +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
xg_timeline / (shotmap_br + shotmap_de)
source("pitch_plots.R")
library(png)
library(cowplot)
library(magick)
logo_file <- system.file("extdata", "germany.png", package = "cowplot")
shots_xg_de <- shots_xg %>%
filter(teamId == 336) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shots_xg_br <- shots_xg %>%
filter(teamId == 409) %>%
filter(xg_clean >= 0.0001) %>%
mutate(isGoal = ifelse(is.na(isGoal), "No_Goal", "Goal"))
shotmap_br <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_br, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.15, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8)) +
coord_fixed()
shotmap_de <- create_opta_ShotMap(grass_colour = "#F9F9F9", line_colour = "#8F8F8F", background_colour = "#F9F9F9", goal_colour = "#000000") +
geom_point(data = shots_xg_de, aes(x = 100-location_y, y = location_x, color = xg_clean, shape = isGoal), size = 3) +
scale_colour_continuous("xG-Wert", type = "viridis", limits = c(0, 0.35)) +
scale_shape_manual(values = c("Goal" = "diamond", "No_Goal" = "circle"), guide=FALSE) +
theme(legend.position = c(0.85, 0.3), legend.key.size = unit(0.2, "cm"), legend.text=element_text(size = 6), legend.title = element_text(size = 8), legend.box.just = "right") +
coord_fixed()
shotmap_br <- ggdraw(shotmap_br) +
draw_image("brazil.png", x = 0.9, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
shotmap_de <- ggdraw(shotmap_de) +
draw_image("germany.png", x = 0.2, y = 0.25, hjust = 1, vjust = 1, width = 0.1, height = 0.1)
xg_timeline / (shotmap_br + shotmap_de)
blogdown:::insert_image_addin()
View(events)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 && second <= 49)
View(event_scene)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49)
View(event_scene)
players <- tbl(con, "players") %>%
collect()
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
View(players)
players <- deframe(players)
players['374']
players[['374']]
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
mutate(spieler = players[[playerId]], mannschaft = players[[teamId]])
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = players[[as.character(teamId)]])
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = players[[as.character(teamId)]])
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]])
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[teamId]])
teams[[409]]
teams[["409"]]
teams <- c("409" = "Brasilien", "336" = "Deutschland")
teams[["409"]]
teams <- c("409" = "Brasilien", "336" = "Deutschland")
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]])
View(event_scene)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft)
View(event_scene)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Lenght, PassEndX, PassEndY)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY) %>%
rename(Minute = minute)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY) %>%
rename(Minute = minute, Sekunde = second, Ort_X = location_x, Ort_Y = location_y, Typ = type_name, Ergebnis = outcome, Ballberuehrung, Tor = isGoal, Schuss = isShot, Spieler = spieler, Mannschaft = mannschaft, Winkel = angle, Laenge = length, End_Ort_X = PassEndX, End_Ort_Y = PassEndY)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY) %>%
rename(Minute = minute, Sekunde = second, Ort_X = location_x, Ort_Y = location_y, Typ = type_name, Ergebnis = outcome, Ballberuehrung = isTouch, Tor = isGoal, Schuss = isShot, Spieler = spieler, Mannschaft = mannschaft, Winkel = angle, Laenge = length, End_Ort_X = PassEndX, End_Ort_Y = PassEndY)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY) %>%
rename(Minute = minute, Sekunde = second, Ort_X = location_x, Ort_Y = location_y, Typ = type_name, Ergebnis = outcome, Ballberuehrung = isTouch, Tor = isGoal, Schuss = isShot, Spieler = spieler, Mannschaft = mannschaft, Winkel = Angle, Laenge = Length, End_Ort_X = PassEndX, End_Ort_Y = PassEndY)
library(DT)
datatable(event_scene)
library(DT)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY) %>%
rename(Minute = minute, Sekunde = second, Spieler = spieler, Mannschaft = mannschaft, Ort_X = location_x, Ort_Y = location_y, Typ = type_name, Ergebnis = outcome, Ballberuehrung = isTouch, Tor = isGoal, Schuss = isShot, Winkel = Angle, Laenge = Length, End_Ort_X = PassEndX, End_Ort_Y = PassEndY)
datatable(event_scene)
library(DT)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY) %>%
rename(Minute = minute, Sekunde = second, Spieler = spieler, Mannschaft = mannschaft, Ort_X = location_x, Ort_Y = location_y, Typ = type_name, Ergebnis = outcome, Ballberuehrung = isTouch, Tor = isGoal, Schuss = isShot, Winkel = Angle, Laenge = Length, End_Ort_X = PassEndX, End_Ort_Y = PassEndY)
datatable(event_scene, rownames = FALSE)
datatable(event_scene, rownames = FALSE, options = list(dom = 't'))
datatable(event_scene, rownames = FALSE, options = list(dom = 't', pageLength = 20))
datatable(event_scene, rownames = FALSE, options = list(dom = 't', pageLength = 20))
library(DT)
teams <- c("409" = "Brasilien", "336" = "Deutschland")
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data_wc.sqlite")
players <- tbl(con, "players") %>%
collect()
DBI::dbDisconnect(con)
players <- deframe(players)
event_scene <- events %>%
filter(minute == 28) %>%
filter(second >= 20 & second <= 49) %>%
rowwise() %>%
mutate(spieler = players[[as.character(playerId)]], mannschaft = teams[[as.character(teamId)]]) %>%
select(minute, second, location_x, location_y, type_name, outcome, isTouch, isGoal, isShot, spieler, mannschaft, Angle, Length, PassEndX, PassEndY) %>%
rename(Minute = minute, Sekunde = second, Spieler = spieler, Mannschaft = mannschaft, Ort_X = location_x, Ort_Y = location_y, Typ = type_name, Ergebnis = outcome, Ballberuehrung = isTouch, Tor = isGoal, Schuss = isShot, Winkel = Angle, Laenge = Length, End_Ort_X = PassEndX, End_Ort_Y = PassEndY) %>%
select(Minute, Sekunde, Spieler, Mannschaft, Typ, Ergebnis, Ballberuehrung, Tor, Schuss, Winkel, Laenge, Ort_X, Ort_Y, End_Ort_X, End_Ort_Y)
datatable(event_scene, rownames = FALSE, options = list(dom = 't', pageLength = 20))
